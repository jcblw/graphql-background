(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{82:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return o})),n.d(t,"metadata",(function(){return i})),n.d(t,"toc",(function(){return p})),n.d(t,"default",(function(){return l}));var r=n(3),a=n(7),s=(n(0),n(86)),o={id:"api-setup",title:"API Setup",sidebar_label:"Setup background API",slug:"/"},i={unversionedId:"api-setup",id:"api-setup",isDocsHomePage:!1,title:"API Setup",description:"Initialize Finch Api",source:"@site/docs/api-setup.md",slug:"/",permalink:"/finch-graphql-docs/docs/",editUrl:"https://github.com/jointoucan/finch-graphql/edit/master/website/docs/api-setup.md",version:"current",sidebar_label:"Setup background API",sidebar:"someSidebar",previous:{title:"How it works",permalink:"/finch-graphql-docs/docs/how-it-works"},next:{title:"Advanced API usage",permalink:"/finch-graphql-docs/docs/advanced-api-usage"}},p=[{value:"Initialize Finch Api",id:"initialize-finch-api",children:[{value:"TypeDefs",id:"typedefs",children:[]},{value:"Resolvers",id:"resolvers",children:[]},{value:"Attaching messaging",id:"attaching-messaging",children:[]}]}],c={toc:p};function l(e){var t=e.components,n=Object(a.a)(e,["components"]);return Object(s.b)("wrapper",Object(r.a)({},c,n,{components:t,mdxType:"MDXLayout"}),Object(s.b)("h2",{id:"initialize-finch-api"},"Initialize Finch Api"),Object(s.b)("p",null,"The ",Object(s.b)("strong",{parentName:"p"},"FinchApi")," class is a class that allows you to create an executable graphql schema. It is modeled to look just like the ",Object(s.b)("strong",{parentName:"p"},"ApolloServer")," class. The only required properties in the options are typeDefs and resolvers."),Object(s.b)("pre",null,Object(s.b)("code",{parentName:"pre",className:"language-typescript"},"import { FinchApi } from 'finch-graphql'\nimport { typeDefs } from './typeDefs'\nimport { resolvers } from './resolvers'\n\n// Create the executable schema\nconst api = new FinchApi({\n  typeDefs,\n  resolver,\n})\n")),Object(s.b)("h3",{id:"typedefs"},"TypeDefs"),Object(s.b)("p",null,Object(s.b)("strong",{parentName:"p"},"TypeDefs")," are schemas for the GraphQL api. These can be a GraphQL document or and array of GraphQL documents. These help you define what the graph contracts of your GraphQL api."),Object(s.b)("pre",null,Object(s.b)("code",{parentName:"pre",className:"language-typescript"},"import gql from 'graphql-tag'\n\nconst browserSchema = gql`\n  input PermissionsInput {\n    origins: [String!]\n    permissions: [String!]\n  }\n\n  type Browser {\n    permissions(input: PermissionsInput!): Boolean!\n  }\n\n  type Query {\n    browser: Browser!\n  }\n`\n\nexport const typeDefs = [browserSchema];\n")),Object(s.b)("p",null,"The ",Object(s.b)("strong",{parentName:"p"},"typeDefs")," exported in the example above can be passed to ",Object(s.b)("strong",{parentName:"p"},"FinchAPI")," as the key ",Object(s.b)("em",{parentName:"p"},"typeDefs")," and we now have a schema."),Object(s.b)("p",null,"You can learn more about what can go into a schema in the ",Object(s.b)("a",{parentName:"p",href:"https://graphql.org/learn/schema/"},"official GraphQL docs"),"."),Object(s.b)("h3",{id:"resolvers"},"Resolvers"),Object(s.b)("p",null,"Resolvers are functions that can be executed in the graph that will allow your to asynchronously query or mutate data. This is the same shape as you would have setting up resolvers in ",Object(s.b)("strong",{parentName:"p"},"ApolloServer"),". "),Object(s.b)("pre",null,Object(s.b)("code",{parentName:"pre",className:"language-typescript"},"const browserResolvers = {\n  Browser: {\n    permissions: (_browser, { input }) => browser.permissions.contains(input),\n  },\n  Query: {\n    browser: () => ({});\n  }\n}\n\nexport const resolvers = {\n  Browser: browserResolvers.Browser,\n  Query: {\n    ...browserResolvers.Query\n  }\n}\n")),Object(s.b)("p",null,"The exported ",Object(s.b)("strong",{parentName:"p"},"resolvers")," variable can now be passed to ",Object(s.b)("strong",{parentName:"p"},"FinchApi")," to be able to setup the functions that get ran when a resolver is queried on the graph."),Object(s.b)("p",null,"Read more about resolvers in the ",Object(s.b)("a",{parentName:"p",href:"https://graphql.org/learn/execution/#root-fields-resolvers"},"official GraphQL docs"),"."),Object(s.b)("h3",{id:"attaching-messaging"},"Attaching messaging"),Object(s.b)("p",null,"To be able to start querying the GraphQL API you will need to attach it to messages so when a message comes into the background script, Finch can determine if it should handle the message."),Object(s.b)("pre",null,Object(s.b)("code",{parentName:"pre",className:"language-typescript"},"const api = new FinchApi({\n  typeDefs,\n  resolver,\n  // auto attach messages\n  attachMessages: true \n})\n")),Object(s.b)("p",null,"Finch GraphQL has a built in way to attach messages. In the example above we pass ",Object(s.b)("strong",{parentName:"p"},"attachMessages")," as ",Object(s.b)("em",{parentName:"p"},"true")," to be able to auto attach messages to the browser messaging API. For projects with existing messages you will probably want to avoid this because it may interfere with responses to other messages. There is another way you can attach to the messaging API without interfering."),Object(s.b)("pre",null,Object(s.b)("code",{parentName:"pre",className:"language-typescript"},"import { FinchMessageKey } from 'finch-graphql'\nimport { api } from './graphql-api'\n\nbrowser.runtime.onMessage.addListener(message => {\n  if (message.type === FinchMessageKey.Generic) {\n    return api.onMessage(message)\n  }\n  // ... do other message stuff\n}, [])\n")),Object(s.b)("p",null,"This will allow you to have your custom messages working properly and be able to use Finch GraphQL as well."))}l.isMDXComponent=!0},86:function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return m}));var r=n(0),a=n.n(r);function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function p(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},s=Object.keys(e);for(r=0;r<s.length;r++)n=s[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)n=s[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var c=a.a.createContext({}),l=function(e){var t=a.a.useContext(c),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},u=function(e){var t=l(e.components);return a.a.createElement(c.Provider,{value:t},e.children)},b={inlineCode:"code",wrapper:function(e){var t=e.children;return a.a.createElement(a.a.Fragment,{},t)}},h=a.a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,s=e.originalType,o=e.parentName,c=p(e,["components","mdxType","originalType","parentName"]),u=l(n),h=r,m=u["".concat(o,".").concat(h)]||u[h]||b[h]||s;return n?a.a.createElement(m,i(i({ref:t},c),{},{components:n})):a.a.createElement(m,i({ref:t},c))}));function m(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var s=n.length,o=new Array(s);o[0]=h;var i={};for(var p in t)hasOwnProperty.call(t,p)&&(i[p]=t[p]);i.originalType=e,i.mdxType="string"==typeof e?e:r,o[1]=i;for(var c=2;c<s;c++)o[c]=n[c];return a.a.createElement.apply(null,o)}return a.a.createElement.apply(null,n)}h.displayName="MDXCreateElement"}}]);