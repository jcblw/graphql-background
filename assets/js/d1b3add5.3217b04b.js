(self.webpackChunkfinch_docs=self.webpackChunkfinch_docs||[]).push([[701],{8192:function(e,t,n){"use strict";n.r(t),n.d(t,{frontMatter:function(){return s},metadata:function(){return i},toc:function(){return p},default:function(){return l}});var r=n(7560),o=n(8283),a=(n(2784),n(876)),s={id:"typescript-codegen",title:"Typescript codegen"},i={unversionedId:"typescript-codegen",id:"typescript-codegen",isDocsHomePage:!1,title:"Typescript codegen",description:"What is codegen?",source:"@site/docs/typescript-codegen.md",sourceDirName:".",slug:"/typescript-codegen",permalink:"/finch-graphql/docs/typescript-codegen",editUrl:"https://github.com/jointoucan/finch-graphql/edit/master/packages/finch-docs/docs/typescript-codegen.md",version:"current",frontMatter:{id:"typescript-codegen",title:"Typescript codegen"},sidebar:"someSidebar",previous:{title:"Finch GraphiQL Devtools",permalink:"/finch-graphql/docs/devtools"}},p=[{value:"What is codegen?",id:"what-is-codegen",children:[]},{value:"Setup",id:"setup",children:[]},{value:"Generating custom hooks",id:"generating-custom-hooks",children:[]}],c={toc:p};function l(e){var t=e.components,n=(0,o.Z)(e,["components"]);return(0,a.kt)("wrapper",(0,r.Z)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h3",{id:"what-is-codegen"},"What is codegen?"),(0,a.kt)("p",null,"Codegen is a way to generate types from a graphQL schema. Typescript is the most common types that would be generated in javascript, and is what kind of codegen that Finch GraphQL supports. The code generator we support is ",(0,a.kt)("a",{parentName:"p",href:"https://www.graphql-code-generator.com"},"GraphQL Code Generator")," and in this page we will go over how to get this setup in your project while using Finch GraphQL."),(0,a.kt)("h3",{id:"setup"},"Setup"),(0,a.kt)("p",null,"GraphQL Code generator has some good documentation on how to ",(0,a.kt)("a",{parentName:"p",href:"https://www.graphql-code-generator.com/docs/getting-started/installation"},"get the library setup"),". Once you have the cli setup you can skip ahead to getting this to work with Finch GraphQL."),(0,a.kt)("h4",{id:"working-with-schemas"},"Working with Schemas"),(0,a.kt)("p",null,"To load in the schema from Finch it is best to use the schemas source files, if it is in the same repo. For example you may want to store all of schema files in a directory like ",(0,a.kt)("inlineCode",{parentName:"p"},"./src/typeDefs/schemas"),". In this example there is a ",(0,a.kt)("inlineCode",{parentName:"p"},"index.ts")," file in the root of typeDefs to export out the array of schemas from the schema folder."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-typescript"},'// ./src/typeDefs/index.ts\nimport gql from "graphql-tag";\nimport browserSchema from "./schemas/browser";\nimport otherSchema from "./schemas/other";\n\nexport const typeDefs = [browserSchema, otherSchema];\n')),(0,a.kt)("p",null,"This makes it so the schemas are consumable by the ",(0,a.kt)("strong",{parentName:"p"},"FinchApi")," ",(0,a.kt)("em",{parentName:"p"},"typeDefs")," option and we can also point codegen towards the schema files. Also in this example the schema files looks something like this."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-typescript"},'// ./src/typeDefs/schema/browser.ts\nimport gql from "graphql-tag";\n\nexport default gql`\n  type Manifest {\n    name: String!\n    version: String!\n    description: String!\n  }\n\n  type Browser {\n    manifest: Manifest\n  }\n\n  extend type Query {\n    browser: Browser\n  }\n`;\n')),(0,a.kt)("p",null,"Now you are setup to point your GraphQL Code Generator config towards these schema files, we would also recommend storing your GraphQL documents that consume the API somewhere close to these schema files as well."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-yaml"},"schema: ./src/typeDefs/schemas/*.ts # Schema files with default exports\ndocuments: ./src/graphql/*.graphql # GraphQL files for clients to consume\ngenerates:\n  ./src/schema/background.ts: # Path to file to be generated\n    plugins: # Common typescript plugins\n      - typescript\n      - typescript-operations\n      - typescript-document-nodes\n")),(0,a.kt)("p",null,"This should generate a file with all the types of the GraphQL queries. Now you should be able to pass the types generated from these queries into ",(0,a.kt)("strong",{parentName:"p"},"queryApi")," and ",(0,a.kt)("strong",{parentName:"p"},"useQuery")," hooks."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-typescript"},'import {\n  GetBrowserManifestQuery,\n  GetBrowserManifestQueryVariables,\n  GetBrowserManifestDocument,\n} from "./schema/background";\n\n// Fully typed response!\nconst resp = queryApi<\n  GetBrowserManifestQuery,\n  GetBrowserManifestQueryVariables\n>(GetBrowserManifestDocument);\n\n// in React component, and useMutation is supported too\nconst { data } = useQuery<\n  GetBrowserManifestQuery,\n  GetBrowserManifestQueryVariables\n>(GetBrowserManifestDocument);\n')),(0,a.kt)("h3",{id:"generating-custom-hooks"},"Generating custom hooks"),(0,a.kt)("p",null,"Finch GraphQL has a module for GraphQL Code Generator that will take these types and generate custom hooks that are hooked into Finch GraphQL. To install the module."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"npm install finch-typescript-codegen --save\n")),(0,a.kt)("p",null,"The update your configuration to look something like this"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-diff"},"generates:\n  ./src/schema/background.ts:\n    plugins:\n      - typescript\n      - typescript-operations\n--    - typescript-document-nodes\n++    - finch-typescript-codegen\n")),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},(0,a.kt)("em",{parentName:"p"},"typescript-document-nodes are now generated by finch-graphql-codegen"))),(0,a.kt)("p",null,"This should run and now your generated file should contain hooks that make it so you do not need to import so many types."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-typescript"},'import { useGetBrowserManifestQuery } from "./schema/background";\n\n// in React component, fully typed!\nconst { data } = useGetBrowserManifestQuery();\n')))}l.isMDXComponent=!0},876:function(e,t,n){"use strict";n.d(t,{Zo:function(){return l},kt:function(){return m}});var r=n(2784);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var p=r.createContext({}),c=function(e){var t=r.useContext(p),n=t;return e&&(n="function"==typeof e?e(t):s(s({},t),e)),n},l=function(e){var t=c(e.components);return r.createElement(p.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},h=r.forwardRef((function(e,t){var n=e.components,o=e.mdxType,a=e.originalType,p=e.parentName,l=i(e,["components","mdxType","originalType","parentName"]),h=c(n),m=o,d=h["".concat(p,".").concat(m)]||h[m]||u[m]||a;return n?r.createElement(d,s(s({ref:t},l),{},{components:n})):r.createElement(d,s({ref:t},l))}));function m(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var a=n.length,s=new Array(a);s[0]=h;var i={};for(var p in t)hasOwnProperty.call(t,p)&&(i[p]=t[p]);i.originalType=e,i.mdxType="string"==typeof e?e:o,s[1]=i;for(var c=2;c<a;c++)s[c]=n[c];return r.createElement.apply(null,s)}return r.createElement.apply(null,n)}h.displayName="MDXCreateElement"}}]);